---
title: "FTAP Homework 5"
author: "Zachary Fogelson"
date: "July 16, 2015"
output: pdf_document
---

```{r, include = F}
library(gdata)
library(plyr)
library(knitr)
```

# Problem 1

**a** 

```{r}
wgs <- read.xls(xls = "censuswage.xls")
lm.out <- lm(Wage ~ School, wgs[wgs$School >= 10,])
confint(lm.out)
```


**b**

```{r}
plot(Wage ~ School, wgs[wgs$School > 10, ], ylim=c(-100, 700))
pred.int <- predict(lm.out, newdata = data.frame(School=c(10:17)), interval = "predict")
conf.int <- predict(lm.out, newdata = data.frame(School=c(10:17)), interval = "confidence")
lines(c(10:17), pred.int[,1], col="red", lwd = 2)
lines(c(10:17), pred.int[,2], col="blue",  type="l", lty=2, lwd = 2)
lines(c(10:17), pred.int[,3], col="blue",  type="l", lty=2, lwd = 2)
lines(c(10:17), conf.int[,2], col="green",  type="l", lty=2, lwd = 2)
lines(c(10:17), conf.int[,3], col="green",  type="l", lty=2, lwd = 2)
```

### Problem 2

```{r}
ceo <- read.xls(xls = "ceosalary.xls")
lm.out <- lm(salary ~ comten + ceoten + sales, ceo)
print(lm.out)  # Point Estimates
summary(lm.out)$coefficients[,"Std. Error"] # Std Errors (You can also see this from sqrt(diag(vcov(lm.out))))
confint(lm.out)  # Confidence intervals
summary(lm.out)$coefficients[,"Pr(>|t|)"]
```

**a**

Because the confidence interval for the slope coefficient of company tenure on ceo salary includes 0. We could hypothesise that company tenure is unrelated to ceo salary. However, company tenure is probably highly correlated with ceo tenure. Therefore, the large covariance between the two variables may be causing the counter intuative relationship between company tenure and salary.

**b**

Because the confidence interval for sales does not include 0 and because the p-value for the statistical significance for sales as a determininent of sales is far below the 99% confidence level we can be confident that theory two is incorrect.


### Probelm 3

```{r}
redrum <- read.xls(xls = "murder.xls")
plot(redrum)
```

**a** 
```{r}
redrum$CapPun <- as.numeric(redrum$exec > 0)
lm.out <- lm(mrdrate ~ unemp + CapPun, redrum)
lm.out
```

**b**

The coefficient on the capital punishment variable means that for a given level of unemployment, whether a community has capital punishment or not is associated with 1.753% higher murder rate.

**c**

```{r}
summary(lm.out)
```

Null Hypothesis:
$H_0: \beta_{2} = 0$

Alternative:
$H_1: \beta_{2} \ne 0$


Because the p-value for $\beta_2$ is >5% we fail to reject the null hypothesis that whether or not a community has capital punishment influences the murder rate.

Controlling for the effects of unemployment, the presence of capital punishment we cannot say that capital punishment is correlated to the murder rate.

**d**

```{r}
predict(lm.out, newdata = data.frame(unemp=c(6,6), CapPun=c(1,0)), interval = "predict")
```

These intervals are very large! Both intervals include 0 also both intervals include values with are both >2x and <x/2 the fit (spot estimate) value.

**e**

```{r}
plot(mrdrate ~ unemp, redrum)
dcUnemp <- redrum[redrum$state == 9,]$unemp
dcMrdrate <- redrum[redrum$state == 9,]$mrdrate
text(x = dcUnemp, y = dcMrdrate, labels = c("DC87 (6.3, 36.2)", "DC90 (6.6, 77.8)", "DC93 (8.5, 78.5)"), cex = .7, pos = 1)
```
