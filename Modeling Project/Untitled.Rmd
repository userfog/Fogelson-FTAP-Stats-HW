---
title: "Modeling Project"
author: "Zachary Fogelson"
date: "July 16, 2015"
output: html_document
---

```{r, include = F}
library(gdata)
library(plyr)
library(knitr)
```

#### Standard

```{r}
rent596 <- read.xls(xls = "rent596.xls")
rent596 <- rename(rent596, c("Year.Built"="Yr", "Sq.Feet..in.100s."="sqft100", "Air.Conditioning"="Ac"))


lm.out <- lm(Rent ~ Bathrooms + sqft100 + Ac + Rooms^2, rent596)
summary(lm.out)
```

#### Descriptive
```{r}
hist(rent596$Rent)
kable(cor(rent596, rent596))
plot(Rent ~ Bathrooms + Yr + sqft100 + Ac + Parking + Rooms, rent596)
```

#### Kitchen Sink
```{r}
kitchenSink <- lm(Rent ~ Bathrooms + Yr + sqft100 + Ac + Parking + Rooms, rent596)
summary(kitchenSink)
```


#### Kitchen Sink No SqFt

```{r}
noSqFt <- lm(Rent ~ Bathrooms + Yr + Ac + Parking + Rooms, rent596)
summary(noSqFt)
```


#### Kitchen Sink log(sqft)
```{r}
rent596$logSqFt100 <- log(rent596$sqft100)
logSqFt <- lm(Rent ~ Bathrooms + Yr + logSqFt100 + Ac + Parking + Rooms, rent596)
summary(logSqFt)
```


#### Decade Dummies
```{r}
rent596$Sixties <- as.numeric(1960 <= rent596$Yr & 1970 > rent596$Yr)
rent596$Seventies <- as.numeric(1970 <= rent596$Yr & 1980 > rent596$Yr)
rent596$Eighties <- as.numeric(1980 <= rent596$Yr & 1990 > rent596$Yr)
rent596$Ninties <- as.numeric(1990 <= rent596$Yr)
rent596$NewConstruction <- as.numeric(1999 <= rent596$Yr)
modelDf <- as.data.frame(model.matrix(~(Bathrooms + Yr+Ac+Parking+Rooms+logSqFt100 + Sixties + Seventies + Eighties + Ninties)^2,rent596))
modelDf$Rent <- rent596$Rent
logSqFt <- lm(Rent ~ Bathrooms + Yr + logSqFt100 + Ac + Parking + Rooms + Sixties + Seventies + Eighties + Ninties + Ac:Sixties + Ac:Seventies + Ac:Eighties + Ac:Ninties + Parking:Sixties + Parking:Seventies + Parking:Eighties + Parking:Ninties + Rooms:Sixties + Rooms:Seventies  +Rooms:Eighties + Rooms:Ninties + logSqFt100:Sixties + logSqFt100:Seventies + logSqFt100:Eighties + logSqFt100:Ninties, modelDf)
summary(logSqFt)
```

#### Kitchen Sink log(sqft) Messin Around
```{r}
rent596$logSqFt100 <- log(rent596$sqft100)
messin <- lm(Rent ~ Bathrooms^2 + Yr + logSqFt100 + Ac + Parking + sqrt(Rooms), rent596)
summary(messin)
```


#### Rooms
```{r}
lm.rooms <- lm(Rent ~ Rooms, rent596)
lm.roomsRoot <- lm(Rent ~ log(Rooms), rent596)
summary(lm.rooms)
summary(lm.roomsRoot)
```

#### Sqft
```{r}
lm.sqft <- lm(Rent ~ log(sqft100), rent596)
plot(Rent ~ log(sqft100), rent596)
abline(lm.sqft)
summary(lm.sqft)
```


#### Only Rooms
```{r}
lm.OnlyRooms <- lm(Rent ~ log(sqft100) + log(Rooms) + Bathrooms, rent596)
summary(lm.OnlyRooms)
```

#### Year Dummies
```{r}

```

#### Agg
```{r}
lm.aggRooms <- lm(Rent ~ log(sqft100) + log(Rooms) + Bathrooms + Ac + Parking, rent596)
summary(lm.aggRooms)
```

#### b)
```{r}
rentScaled <- as.data.frame(scale(rent596))
plot(rentScaled)
cor(rentScaled)
kable(head(cor(rentScaled)), n = length(rentScaled)/2 + 1)
lm.out <- lm(Rent ~ Rooms, rentScaled)
plot(Rent ~ Rooms, rentScaled)
abline(lm.out, col = "red")
summary(lm.out)

minusRooms <- data.frame(RoomsResid=lm.out$residuals)
minusRooms <- cbind(minusRooms, rentScaled[, -7])

plot(minusRooms)


rentScaled$aggRooms <- (rentScaled$Rooms + rentScaled$Bathrooms*2 + rentScaled$sqft100)/3

lm.out2 <- lm(Rent ~ rentScaled$aggRooms + Ac + Parking + Yr, rentScaled)
summary(lm.out2)
```